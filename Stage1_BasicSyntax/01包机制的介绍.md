# Go 语言包（package）机制新手完全指南

> 写给刚接触 Go 的新手：用「文件夹 + 工具箱」的通俗逻辑，讲透包是什么、`package main` 为什么必须写、包该怎么用，全程避开复杂术语，只讲新手必懂的核心。

## 一、先搞懂：包（package）到底是什么？

### 1. 最通俗的比喻

你可以把 Go 的「包」理解成：

- **电脑里的文件夹**：每个包对应一个文件夹，用来把功能相关的代码放在一起（比如把 “计算相关的代码” 放一个文件夹，“打印相关的代码” 放另一个），避免所有代码堆在一个文件里乱糟糟；
- **工具箱**：不同的包对应不同的工具箱 —— 比如 `fmt` 包是 “输入输出工具箱”，里面装了 `Println()`（打印）、`Scan()`（读取输入）这些工具；你自己写的 `utils` 包可以是 “数学计算工具箱”，装 `Add()`、`Sub()` 这些工具。

### 2. 新手必须记住的核心规则

Go 语言对包有 3 条 “强制规定”，记死这 3 条就不会踩基础坑：

1. **所有 `.go` 文件第一行必须声明包名**：就像每个文件必须归到某个文件夹里，不能 “飘着”，格式是 `package 包名`；
2. **包名可以和文件夹名不一致（但建议一致）**：比如文件夹叫 `tool`，里面的文件可以写 `package utils`，但新手直接让包名 = 文件夹名最省心；
3. **同一个文件夹里的所有 `.go` 文件，必须声明同一个包名**：比如 `utils` 文件夹里的 `add.go` 和 `sub.go`，第一行都得是 `package utils`，不能一个写 `utils` 一个写 `tool`。

## 二、包的两种类型：新手最关心的核心

Go 的包只分两种，`package main` 是其中唯一的 “特殊款”，先看对比表（新手记这个表就够了）：

|     包类型     |            声明格式             |        通俗理解         | 能否直接运行 |                 核心特征                 |
| :------------: | :-----------------------------: | :---------------------: | :----------: | :--------------------------------------: |
|    可执行包    |         `package main`          | 能直接打开的 “应用程序” |     ✅ 能     | 必须搭配 `func main()` 函数（程序入口）  |
| 库包（普通包） | `package 自定义名`（如`utils`） |    装工具的 “工具箱”    |    ❌ 不能    | 没有 `main()` 函数，只能被其他包导入使用 |

### 1. 可执行包（package main）：新手写得最多的包

#### （1）为什么必须写 `package main`？

- 告诉 Go 编译器：“我写的不是‘工具箱’，是能直接运行的程序（比如猜数字游戏、计算器）”；
- 如果不写 `package main`，编译器只会生成 “工具箱文件（.a）”，没法直接运行。

#### （2）`main()` 函数是啥？—— 程序的 “启动开关”

`package main` 必须搭配 `func main()` 函数（缺一不可），`main()` 函数就是程序的 “开场按钮”：

- 操作系统运行你的程序时，会从 `main()` 函数的第一行开始执行；
- 哪怕你写了 1000 行代码，只要 `main` 包里没有 `main()` 函数，编译时直接报错（编译器不知道 “从哪开始运行”）。

#### （3）新手极简示例：能直接运行的 `main` 包

新建文件 `hello.go`，写入以下代码（复制就能用）：

go

运行

```go
// 第一步：声明这是可执行包（必须写）
package main  

// 导入“输入输出工具箱”fmt
import "fmt"

// 第二步：定义程序入口（必须写，函数名不能改）
func main() {
    // 调用fmt工具箱里的Println工具
    fmt.Println("新手也能看懂的可执行包！")
}
```

运行命令（终端里敲）：

bash

运行

```
go run hello.go
```

输出结果：

plaintext

```go
新手也能看懂的可执行包！
```

### 2. 库包（普通包）：给可执行包 “提供工具”

#### （1）通俗理解

库包就是 “只装工具、不能直接打开的工具箱”—— 比如你写一个 `utils` 包，里面装个加法函数，然后在 `main` 包里调用这个函数。

#### （2）新手极简示例：写库包 + 调用库包

##### 步骤 1：新建文件夹和库包文件

- 新建文件夹 `utils`（建议和包名一致）；
- 在 `utils` 里新建 `add.go`，写入代码：

go

运行

```
// 声明这是库包，包名=文件夹名（新手推荐）
package utils  

// 定义加法工具（函数名首字母大写才能被外部包调用，新手先记这个规则）
func Add(a, b int) int {
    return a + b
}
```

##### 步骤 2：在 `main` 包里调用这个库包

新建文件 `main.go`（和 `utils` 文件夹同级），写入代码：

go

运行

```
package main  

import (
    "fmt"
    // 导入自定义的utils包（路径是“相对路径”，新手直接写文件夹名即可）
    "./utils"
)

func main() {
    // 调用utils工具箱里的Add工具
    res := utils.Add(1, 2)
    fmt.Println("1+2的结果是：", res)
}
```

##### 步骤 3：运行 `main.go`

终端敲命令：

bash

运行

```
go run main.go
```

输出结果：

plaintext

```
1+2的结果是： 3
```

## 三、新手常见问题 & 踩坑点（避坑指南）

### 1. 报错：`cannot run non-main package`

- 原因：直接运行了库包文件（比如直接 `go run utils/add.go`）；
- 解决：库包不能直接运行，必须在 `main` 包里导入后，运行 `main` 包文件。

### 2. 报错：`undefined: main`

- 原因：写了 `package main`，但没定义 `func main()` 函数；
- 解决：补上 `func main() {}`（哪怕里面是空的，也能编译通过）。

### 3. 调用库包函数时报错：`undefined: utils.Add`

- 原因：库包函数名首字母小写了（比如 `func add()` 而不是 `func Add()`）；
- 解决：Go 规定 “首字母大写的函数 / 变量才能被外部包调用”，新手写库包函数时首字母都大写就好。

## 四、新手核心总结（3 句话记完包机制）

1. **包是代码的 “文件夹 / 工具箱”**：所有 `.go` 文件必须归到某个包，第一行写 `package 包名`；
2. **想让代码能直接运行，就写 `package main + func main()`**：这是可执行程序的 “标配”，缺一不可；
3. **想写工具函数给别人用，就写普通库包**：包名自定义（比如 `utils`），函数首字母大写才能被调用。

新手阶段不用纠结包的高级用法（比如包的导入路径、模块化管理），先把 “可执行包 + 库包调用” 这两个基础用熟，后续写复杂项目时再慢慢拓展。

